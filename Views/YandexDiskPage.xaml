<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Library.Views.YandexDiskPage"
             Title="Ð¯Ð½Ð´ÐµÐºÑ Ð”Ð¸ÑÐº"
             BackgroundColor="{DynamicResource PageBackgroundColor}">
    
    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">
            
            <!-- Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ -->
            <Border BackgroundColor="{DynamicResource PrimaryColor}" Padding="15" StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Ð¡Ñ‚Ð°Ñ‚ÑƒÑ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ" 
                           FontSize="18" 
                           FontAttributes="Bold"
                           TextColor="{DynamicResource SecondaryTextColor}"/>
                    <Label x:Name="StatusLabel" 
                           Text="ÐÐµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾" 
                           FontSize="14"
                           TextColor="{DynamicResource SecondaryTextColor}"/>
                    <Label x:Name="DiskInfoLabel" 
                           Text="" 
                           FontSize="12"
                           TextColor="{DynamicResource SecondaryTextColor}"
                           IsVisible="False"/>
                </VerticalStackLayout>
            </Border>

            <!-- ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ -->
            <Border BackgroundColor="{DynamicResource CardBackgroundColor}" Padding="15" StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="10">
                    <Label Text="ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ" 
                           FontSize="18" 
                           FontAttributes="Bold"
                           TextColor="{DynamicResource PrimaryTextColor}"/>
                    
                    <Label Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ¿Ð¾ÑÐ¾Ð± Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸:" 
                           FontSize="14"
                           TextColor="{DynamicResource SecondaryTextColor}"/>
                    
                    <!-- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ -->
                    <Button Text="ðŸ” Ð’Ð¾Ð¹Ñ‚Ð¸ Ñ‡ÐµÑ€ÐµÐ· Ð¯Ð½Ð´ÐµÐºÑ" 
                            Clicked="OnGetTokenClicked"
                            BackgroundColor="{DynamicResource PrimaryColor}"
                            TextColor="{DynamicResource SecondaryTextColor}"
                            FontSize="16"
                            FontAttributes="Bold"
                            HeightRequest="50"/>
                    
                    <Label Text="Ð¸ Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚Ð¾ÐºÐµÐ½ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ:" 
                           FontSize="12"
                           TextColor="{DynamicResource SecondaryTextColor}"
                           HorizontalOptions="Center"
                           Margin="0,10,0,0"/>
                    
                    <Entry x:Name="TokenEntry" 
                           Placeholder="Ð’ÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ OAuth Ñ‚Ð¾ÐºÐµÐ½ Ð·Ð´ÐµÑÑŒ"
                           IsPassword="True"
                           TextColor="{DynamicResource PrimaryTextColor}"
                           PlaceholderColor="{DynamicResource SecondaryTextColor}"/>
                    
                    <HorizontalStackLayout Spacing="10">
                        <Button Text="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ñ‚Ð¾ÐºÐµÐ½" 
                                Clicked="OnSaveTokenClicked"
                                BackgroundColor="{DynamicResource PrimaryColor}"
                                TextColor="{DynamicResource SecondaryTextColor}"
                                HorizontalOptions="Fill"/>
                        <Button Text="ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ" 
                                Clicked="OnDisconnectClicked"
                                BackgroundColor="{DynamicResource Gray400}"
                                TextColor="{DynamicResource PrimaryTextColor}"
                                HorizontalOptions="Fill"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Border>

            <!-- Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ -->
            <Border BackgroundColor="{DynamicResource CardBackgroundColor}" Padding="15" StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="10">
                    <Label Text="Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ" 
                           FontSize="18" 
                           FontAttributes="Bold"
                           TextColor="{DynamicResource PrimaryTextColor}"/>
                    
                    <Label x:Name="LastBackupLabel" 
                           Text="ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÑÑ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð°Ñ ÐºÐ¾Ð¿Ð¸Ñ: Ð½Ð¸ÐºÐ¾Ð³Ð´Ð°" 
                           FontSize="14"
                           TextColor="{DynamicResource SecondaryTextColor}"/>
                    
                    <Button Text="Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½ÑƒÑŽ ÐºÐ¾Ð¿Ð¸ÑŽ" 
                            Clicked="OnBackupClicked"
                            BackgroundColor="{DynamicResource PrimaryColor}"
                            TextColor="{DynamicResource SecondaryTextColor}"/>
                    
                    <Button Text="Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¸Ð· Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸" 
                            Clicked="OnRestoreClicked"
                            BackgroundColor="{DynamicResource SecondaryColor}"
                            TextColor="{DynamicResource SecondaryTextColor}"/>
                    
                    <!-- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ -->
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ" 
                               VerticalOptions="Center"
                               HorizontalOptions="Start"
                               TextColor="{DynamicResource PrimaryTextColor}"/>
                        <Switch x:Name="AutoBackupSwitch" 
                                Toggled="OnAutoBackupToggled"/>
                    </HorizontalStackLayout>
                    
                    <HorizontalStackLayout Spacing="10" x:Name="FrequencyLayout" IsVisible="False">
                        <Label Text="Ð§Ð°ÑÑ‚Ð¾Ñ‚Ð° (Ð´Ð½ÐµÐ¹):" 
                               VerticalOptions="Center"
                               TextColor="{DynamicResource PrimaryTextColor}"/>
                        <Entry x:Name="FrequencyEntry" 
                               Text="7" 
                               Keyboard="Numeric"
                               WidthRequest="60"
                               HorizontalTextAlignment="Center"
                               TextColor="{DynamicResource PrimaryTextColor}"
                               PlaceholderColor="{DynamicResource SecondaryTextColor}"/>
                        <Button Text="Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ" 
                                Clicked="OnSaveFrequencyClicked"
                                Padding="10,5"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Border>

            <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ñ… ÐºÐ¾Ð¿Ð¸Ð¹ -->
            <Border BackgroundColor="{DynamicResource CardBackgroundColor}" Padding="15" StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Ð ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¿Ð¸Ð¸" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               HorizontalOptions="Start"
                               VerticalOptions="Center"
                               TextColor="{DynamicResource PrimaryTextColor}"/>
                        <Button Text="ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ" 
                                Clicked="OnRefreshBackupsClicked"
                                BackgroundColor="{DynamicResource PrimaryColor}"
                                TextColor="{DynamicResource SecondaryTextColor}"
                                Padding="10,5"/>
                    </HorizontalStackLayout>
                    
                    <ActivityIndicator x:Name="LoadingIndicator" 
                                     IsRunning="False" 
                                     IsVisible="False"
                                     Color="{DynamicResource PrimaryColor}"/>
                    
                    <CollectionView x:Name="BackupsCollectionView" 
                                  SelectionMode="Single"
                                  SelectionChanged="OnBackupSelectionChanged">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="10" 
                                       Margin="0,5" 
                                       BackgroundColor="{DynamicResource Gray100}" 
                                       StrokeThickness="2"
                                       Stroke="Transparent">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="5"/>
                                    </Border.StrokeShape>
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup Name="CommonStates">
                                            <VisualState Name="Normal">
                                                <VisualState.Setters>
                                                    <Setter Property="BackgroundColor" Value="{DynamicResource Gray100}" />
                                                    <Setter Property="Stroke" Value="Transparent" />
                                                </VisualState.Setters>
                                            </VisualState>
                                            <VisualState Name="Selected">
                                                <VisualState.Setters>
                                                    <Setter Property="BackgroundColor" Value="{DynamicResource SecondaryColor}" />
                                                    <Setter Property="Stroke" Value="{DynamicResource SecondaryColor}" />
                                                </VisualState.Setters>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <VerticalStackLayout Spacing="5">
                                        <Label x:Name="BackupNameLabel"
                                               Text="{Binding Name}" 
                                               FontSize="14" 
                                               FontAttributes="Bold"
                                               TextColor="{DynamicResource PrimaryTextColor}">
                                            <VisualStateManager.VisualStateGroups>
                                                <VisualStateGroup Name="CommonStates">
                                                    <VisualState Name="Normal">
                                                        <VisualState.Setters>
                                                            <Setter Property="TextColor" Value="{DynamicResource PrimaryTextColor}" />
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                    <VisualState Name="Selected">
                                                        <VisualState.Setters>
                                                            <Setter Property="TextColor" Value="{DynamicResource SecondaryTextColor}" />
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                </VisualStateGroup>
                                            </VisualStateManager.VisualStateGroups>
                                        </Label>
                                        <Label x:Name="BackupCreatedLabel"
                                               Text="{Binding Created, StringFormat='Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾: {0:dd.MM.yyyy HH:mm}'}" 
                                               FontSize="12"
                                               TextColor="{DynamicResource SecondaryTextColor}">
                                            <VisualStateManager.VisualStateGroups>
                                                <VisualStateGroup Name="CommonStates">
                                                    <VisualState Name="Normal">
                                                        <VisualState.Setters>
                                                            <Setter Property="TextColor" Value="{DynamicResource SecondaryTextColor}" />
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                    <VisualState Name="Selected">
                                                        <VisualState.Setters>
                                                            <Setter Property="TextColor" Value="{DynamicResource SecondaryTextColor}" />
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                </VisualStateGroup>
                                            </VisualStateManager.VisualStateGroups>
                                        </Label>
                                        <Label x:Name="BackupSizeLabel"
                                               Text="{Binding Size, StringFormat='Ð Ð°Ð·Ð¼ÐµÑ€: {0:N0} Ð±Ð°Ð¹Ñ‚'}" 
                                               FontSize="12"
                                               TextColor="{DynamicResource SecondaryTextColor}">
                                            <VisualStateManager.VisualStateGroups>
                                                <VisualStateGroup Name="CommonStates">
                                                    <VisualState Name="Normal">
                                                        <VisualState.Setters>
                                                            <Setter Property="TextColor" Value="{DynamicResource SecondaryTextColor}" />
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                    <VisualState Name="Selected">
                                                        <VisualState.Setters>
                                                            <Setter Property="TextColor" Value="{DynamicResource SecondaryTextColor}" />
                                                        </VisualState.Setters>
                                                    </VisualState>
                                                </VisualStateGroup>
                                            </VisualStateManager.VisualStateGroups>
                                        </Label>
                                    </VerticalStackLayout>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                    
                    <Label x:Name="NoBackupsLabel" 
                           Text="Ð ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¿Ð¸Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹" 
                           FontSize="14"
                           TextColor="{DynamicResource SecondaryTextColor}"
                           HorizontalOptions="Center"
                           IsVisible="False"/>
                </VerticalStackLayout>
            </Border>

            <!-- Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ -->
            <Border Padding="15" BackgroundColor="{DynamicResource Gray100}" StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10"/>
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="10">
                    <Label Text="ðŸ’¡ ÐšÐ°Ðº Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¯Ð½Ð´ÐµÐºÑ Ð”Ð¸ÑÐº?" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           TextColor="{DynamicResource PrimaryTextColor}"/>
                    <Label FontSize="14" TextColor="{DynamicResource SecondaryTextColor}">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±:&#x0a;" FontAttributes="Bold"/>
                                <Span Text="1. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ ÐºÐ½Ð¾Ð¿ÐºÑƒ 'ðŸ” Ð’Ð¾Ð¹Ñ‚Ð¸ Ñ‡ÐµÑ€ÐµÐ· Ð¯Ð½Ð´ÐµÐºÑ'&#x0a;"/>
                                <Span Text="2. Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ Ð² ÑÐ²Ð¾Ð¹ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚ Ð¯Ð½Ð´ÐµÐºÑ Ð² Ð¾Ñ‚ÐºÑ€Ñ‹Ð²ÑˆÐµÐ¼ÑÑ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ&#x0a;"/>
                                <Span Text="3. Ð Ð°Ð·Ñ€ÐµÑˆÐ¸Ñ‚Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð¯Ð½Ð´ÐµÐºÑ Ð”Ð¸ÑÐºÑƒ&#x0a;"/>
                                <Span Text="4. Ð’ÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ð¹ Ñ‚Ð¾ÐºÐµÐ½ &#x0a;"/>
                                <Span Text="5. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ 'Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ñ‚Ð¾ÐºÐµÐ½':&#x0a;"/>
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>
                </VerticalStackLayout>
            </Border>
            
        </VerticalStackLayout>
    </ScrollView>
    
</ContentPage>
