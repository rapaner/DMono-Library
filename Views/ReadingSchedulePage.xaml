<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="Library.Views.ReadingSchedulePage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:Library.Models"
             Title="Ð“Ñ€Ð°Ñ„Ð¸Ðº Ñ‡Ñ‚ÐµÐ½Ð¸Ñ"
             BackgroundColor="{DynamicResource PageBackgroundColor}">

    <ScrollView>
        <StackLayout Padding="20" Spacing="20">
            
            <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ ÐºÐ½Ð¸Ð³Ðµ -->
            <Border BackgroundColor="{DynamicResource CardBackgroundColor}" 
                   Padding="20" 
                   StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="15"/>
                </Border.StrokeShape>
                <StackLayout>
                    <Label x:Name="BookTitleLabel" 
                           FontSize="20" 
                           FontAttributes="Bold" 
                           TextColor="{DynamicResource PrimaryTextColor}" />
                    <Label x:Name="BookAuthorLabel" 
                           FontSize="16" 
                           TextColor="{DynamicResource SecondaryTextColor}" 
                           Margin="0,5,0,10" />
                    <Label x:Name="ProgressLabel" 
                           FontSize="16" 
                           TextColor="{DynamicResource PrimaryTextColor}" />
                </StackLayout>
            </Border>

            <!-- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ -->
            <Border BackgroundColor="{DynamicResource CardBackgroundColor}" 
                   Padding="20" 
                   StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="15"/>
                </Border.StrokeShape>
                <StackLayout Spacing="15">
                    <Label Text="âš™ï¸ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ" 
                           FontSize="18" 
                           FontAttributes="Bold" 
                           TextColor="{DynamicResource PrimaryTextColor}" />

                    <!-- Ð”Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ -->
                    <StackLayout>
                        <Label Text="Ð¦ÐµÐ»ÐµÐ²Ð°Ñ Ð´Ð°Ñ‚Ð° Ð¾ÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ñ" 
                               FontSize="14" 
                               TextColor="{DynamicResource SecondaryTextColor}" />
                        <DatePicker x:Name="FinishDatePicker" 
                                    MinimumDate="01/01/2020"
                                    DateSelected="OnFinishDateSelected"
                                    TextColor="{DynamicResource PrimaryTextColor}"
                                    BackgroundColor="{DynamicResource InputBackgroundColor}"
                                    Margin="0,5,0,0" />
                    </StackLayout>

                    <!-- Ð§Ð°ÑÑ‹ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ -->
                    <StackLayout>
                        <Label Text="Ð§Ð°ÑÑ‹ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ" 
                               FontSize="14" 
                               TextColor="{DynamicResource SecondaryTextColor}" />
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,5,0,0">
                            <StackLayout Grid.Column="0">
                                <Label Text="ÐÐ°Ñ‡Ð°Ð»Ð¾ (Ñ‡Ð°Ñ)" 
                                       FontSize="12" 
                                       TextColor="{DynamicResource SecondaryTextColor}" />
                                <Entry x:Name="StartHourEntry" 
                                       Keyboard="Numeric"
                                       Placeholder="6"
                                       TextColor="{DynamicResource PrimaryTextColor}"
                                       PlaceholderColor="{DynamicResource SecondaryTextColor}"
                                       BackgroundColor="{DynamicResource InputBackgroundColor}"
                                       TextChanged="OnHoursChanged" />
                            </StackLayout>
                            <StackLayout Grid.Column="1">
                                <Label Text="ÐžÐºÐ¾Ð½Ñ‡Ð°Ð½Ð¸Ðµ (Ñ‡Ð°Ñ)" 
                                       FontSize="12" 
                                       TextColor="{DynamicResource SecondaryTextColor}" />
                                <Entry x:Name="EndHourEntry" 
                                       Keyboard="Numeric"
                                       Placeholder="23"
                                       TextColor="{DynamicResource PrimaryTextColor}"
                                       PlaceholderColor="{DynamicResource SecondaryTextColor}"
                                       BackgroundColor="{DynamicResource InputBackgroundColor}"
                                       TextChanged="OnHoursChanged" />
                            </StackLayout>
                        </Grid>
                        <Label x:Name="HoursHintLabel"
                               Text="ÐžÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ Ð¿ÑƒÑÑ‚Ñ‹Ð¼ Ð´Ð»Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº" 
                               FontSize="12" 
                               TextColor="{DynamicResource SecondaryTextColor}" 
                               Margin="0,5,0,0" />
                    </StackLayout>

                    <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° -->
                    <Button x:Name="CalculateButton"
                            Text="ðŸ“Š Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð³Ñ€Ð°Ñ„Ð¸Ðº" 
                            BackgroundColor="{DynamicResource PrimaryColor}" 
                            TextColor="{DynamicResource SecondaryTextColor}" 
                            CornerRadius="10" 
                            Margin="0,10,0,0"
                            Clicked="OnCalculateClicked" />
                </StackLayout>
            </Border>

            <!-- ÐŸÐ¾Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð¹ Ð³Ñ€Ð°Ñ„Ð¸Ðº (Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð°) -->
            <Border x:Name="ScheduleBorder"
                   BackgroundColor="{DynamicResource CardBackgroundColor}" 
                   Padding="20" 
                   StrokeThickness="0"
                   IsVisible="False">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="15"/>
                </Border.StrokeShape>
                <StackLayout>
                    <Label Text="ðŸ“… ÐŸÐ¾Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð¹ Ð³Ñ€Ð°Ñ„Ð¸Ðº" 
                           FontSize="18" 
                           FontAttributes="Bold" 
                           TextColor="{DynamicResource PrimaryTextColor}" 
                           Margin="0,0,0,15" />

                    <Label x:Name="ScheduleSummaryLabel"
                           FontSize="14"
                           TextColor="{DynamicResource PrimaryTextColor}"
                           Margin="0,0,0,15" />

                    <CollectionView x:Name="ScheduleCollectionView"
                                   SelectionMode="None">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:ReadByHourRecord">
                                <Border BackgroundColor="{DynamicResource InputBackgroundColor}" 
                                       Padding="15" 
                                       Margin="0,5"
                                       StrokeThickness="0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="10"/>
                                    </Border.StrokeShape>
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Grid.Column="0"
                                               Text="{Binding TimeStamp}" 
                                               FontSize="14" 
                                               TextColor="{DynamicResource PrimaryTextColor}"
                                               VerticalOptions="Center" />
                                        <Label Grid.Column="1"
                                               FontSize="16" 
                                               FontAttributes="Bold"
                                               TextColor="{DynamicResource TertiaryColor}"
                                               VerticalOptions="Center">
                                            <Label.Text>
                                                <Binding Path="Pages" StringFormat="{}{0:F0} ÑÑ‚Ñ€." />
                                            </Label.Text>
                                        </Label>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>
            </Border>

            <!-- Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ -->
            <ActivityIndicator x:Name="LoadingIndicator" 
                              IsRunning="False" 
                              Color="{DynamicResource PrimaryColor}"
                              HeightRequest="50" />
        </StackLayout>
    </ScrollView>
</ContentPage>

